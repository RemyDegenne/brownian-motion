\chapter{Brownian motion}
\label{chap:brownian}


\section{Stochastic process with continuous paths}

\begin{definition}[pre-Brownian process]\label{def:preBrownian}
  \uses{def:gaussianLimit}
  \leanok
  \lean{ProbabilityTheory.preBrownian}
Let $\Omega = \mathbb{R}^{\mathbb{R}_+}$ and consider the probability space $(\Omega, P_B)$ (where $P_B$ is the measure defined in Definition~\ref{def:gaussianLimit}).
The identity on that space is a function $\Omega \to \mathbb{R}_+ \to \mathbb{R}$.
We reorder the arguments to define a stochastic process $X : \mathbb{R}_+ \to \Omega \to \mathbb{R}$, which we call the pre-Brownian process.
\end{definition}


\begin{lemma}\label{lem:isGaussianProcess_preBrownian}
  \uses{def:preBrownian, def:IsGaussianProcess}
  \leanok
  \lean{ProbabilityTheory.isGaussianProcess_preBrownian}
  The pre-Brownian process $X$ of Definition~\ref{def:preBrownian} is a Gaussian process.
\end{lemma}

\begin{proof}\leanok
  \uses{lem:isGaussian_multivariateGaussian}

\end{proof}


\begin{lemma}\label{lem:map_sub_preBrownian}
  \uses{def:preBrownian}
  \leanok
  \lean{ProbabilityTheory.map_sub_preBrownian}
Let $X$ be the pre-Brownian process of Definition~\ref{def:preBrownian}.
Then, for all $s, t \in \mathbb{R}_+$, the random variable $X_t - X_s$ is a Gaussian random variable with mean $0$ and variance $|t - s|$.
\end{lemma}

\begin{proof}

\end{proof}


\begin{lemma}\label{lem:isKolmogorovProcess_preBrownian}
  \uses{def:preBrownian}
  \leanok
  \lean{ProbabilityTheory.isKolmogorovProcess_preBrownian}
The pre-Brownian process $X$ of Definition~\ref{def:preBrownian} satisfies the Kolmogorov condition for exponents $(2n,n)$ with constant $(2n - 1)!!$ for all $n \in \mathbb{N}$.
That is, for all $s, t \in \mathbb{R}_+$, we have
\begin{align*}
  \mathbb{E} \left[ |X_t - X_s|^{2n} \right] \le (2n - 1)!! |t - s|^n
  \: .
\end{align*}
\end{lemma}

\begin{proof}
  \uses{lem:centralMoment_two_mul_gaussianReal, lem:map_sub_preBrownian}
$X_t - X_s$ is a Gaussian random variable with mean $0$ and variance $|t - s|$ (Lemma~\ref{lem:map_sub_preBrownian}).
Thus, by Lemma~\ref{lem:centralMoment_two_mul_gaussianReal}, we have
\begin{align*}
  \mathbb{E} \left[ |X_t - X_s|^{2n} \right]
  = (2n - 1)!! |t - s|^n
  \: .
\end{align*}
\end{proof}


\begin{definition}[Brownian motion]\label{def:brownian}
  \uses{thm:localized_holder_modification_sup, def:preBrownian, lem:isKolmogorovProcess_preBrownian, lem:hasBoundedCoveringNumberCover_nnreal}
  \leanok
By Theorem~\ref{thm:localized_holder_modification_sup}, there exists a modification $B$ of the pre-Brownian process such that all the paths of $B$ are Hölder continuous of all orders $\gamma \in (0, 1/2)$.
We call $B$ the \emph{Brownian motion} on $\mathbb{R}_+$.
\end{definition}


\begin{lemma}\label{lem:isGaussianProcess_brownian}
  \uses{def:brownian, def:IsGaussianProcess}
  \leanok
  \lean{ProbabilityTheory.isGaussianProcess_brownian}
The Brownian motion is a Gaussian process.
\end{lemma}

\begin{proof}\leanok
  \uses{lem:isGaussianProcess_of_modification, lem:isGaussianProcess_preBrownian}
The pre-Brownian process is a Gaussian process by Lemma~\ref{lem:isGaussianProcess_preBrownian}.
The Brownian motion is a modification of the pre-Brownian process by Definition~\ref{def:brownian}.
Thus, the Brownian motion is a Gaussian process as well by Lemma~\ref{lem:isGaussianProcess_of_modification}.
\end{proof}


\begin{lemma}\label{lem:isHolderWith_brownian}
  \uses{def:brownian}
  \leanok
  \lean{ProbabilityTheory.isHolderWith_brownian}
The paths of the Brownian motion are Hölder continuous of all orders $\gamma \in (0, 1/2)$.
\end{lemma}

\begin{proof}

\end{proof}


\begin{lemma}\label{lem:continuous_brownian}
  \uses{def:brownian}
  \leanok
  \lean{ProbabilityTheory.continuous_brownian}
The paths of the Brownian motion are continuous.
\end{lemma}

\begin{proof}
  \uses{lem:isHolderWith_brownian}

\end{proof}


\begin{lemma}\label{lem:law_brownian_apply}
  \uses{def:brownian}
For $t \in \mathbb{R}_+$, the law of $B_t$ (the Brownian motion at time $t$) is the real Gaussian measure $\mathcal{N}(0,t)$.
\end{lemma}

\begin{proof}

\end{proof}

\section{Wiener measure on the continuous functions}

We want to turn the Brownian motion into a measure on the continuous functions $C(\mathbb{R}_+, \mathbb{R})$ with the Borel sigma-algebra generated by the compact-open topology.


\begin{definition}[Auxiliary Wiener measure]\label{def:wienerMeasureAux}
  \uses{def:brownian, def:gaussianLimit, lem:continuous_brownian}
  \leanok
  \lean{ProbabilityTheory.wienerMeasureAux}
The pushforward of the measure $P_B$ of Definition~\ref{def:gaussianLimit} by the Brownian motion $B$ is a measure on the continuous functions on $\mathbb{R}^{\mathbb{R}_+}$, with the sigma-algebra induced by the product sigma-algebra on $\mathbb{R}^{\mathbb{R}_+}$.
\end{definition}

\textbf{Lean remark}: the auxiliary Wiener measure is a measure on the subtype \texttt{\{f  // Continuous f\}}. This is not the same type as $C(\mathbb{R}_+, \mathbb{R})$.


\begin{theorem}\label{thm:ContinuousMap.borel_eq_iSup_comap_eval}
  \leanok
  \lean{ProbabilityTheory.ContinuousMap.borel_eq_iSup_comap_eval}
The borel sigma-algebra on $C(\mathbb{R}_+, \mathbb{R})$ coming from the compact-open topology is equal to the smallest sigma-algebra for which the evaluation maps $f \mapsto f(t)$ are measurable for every $t \in \mathbb{R}_+$.
\end{theorem}

\begin{proof}
Possible ref: \href{https://math.stackexchange.com/questions/4789531/when-does-the-borel-sigma-algebra-of-compact-convergence-coincide-with-the-pr}{stackexchange question}.
\end{proof}


\begin{definition}\label{def:MeasurableEquiv.continuousMap}
  \uses{thm:ContinuousMap.borel_eq_iSup_comap_eval}
  \leanok
  \lean{ProbabilityTheory.MeasurableEquiv.continuousMap}
The identity is a measurable equivalence between the continuous functions of $\mathbb{R}^{\mathbb{R}_+}$ with the subset sigma-algebra obtained from the product sigma-algebra, and $C(\mathbb{R}_+, \mathbb{R})$ with the Borel sigma-algebra coming from the compact-open topology.

Mathematically this says nothing more than the equality of sigma-algebras of Theorem~\ref{thm:ContinuousMap.borel_eq_iSup_comap_eval} but in Lean we have two different types so we need an equivalence.
\end{definition}


\begin{definition}[Wiener measure]\label{def:wienerMeasure}
  \uses{def:MeasurableEquiv.continuousMap, def:wienerMeasureAux}
  \leanok
  \lean{ProbabilityTheory.wienerMeasure}
The Wiener measure on $C(\mathbb{R}_+, \mathbb{R})$ with the Borel sigma-algebra is the map of the auxiliary Wiener measure by the measurable equivalence of definition~\ref{def:MeasurableEquiv.continuousMap}.
\end{definition}


TODO: add the main properties of the Brownian motion and the Wiener measure.
We need to be able to tell that we have built the correct objects.
