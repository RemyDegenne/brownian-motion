\chapter{Kolmogorov-Chentsov Theorem}
\label{chap:kolmogorov_chentsov}

We follow the proof of the Kolmogorov-Chentsov theorem from \cite{kratschmer2023kolmogorov}.
That proof notably uses the chaining technique developed by Talagrand \cite{talagrand2022upper}.

That theorem is about stochastic processes $X : T \to \Omega \to E$, where $\Omega$ is a measurable space with a probability measure $\mathbb{P}$, the index set $T$ is a metric space with distance $d_T$, and $E$ is also a metric space with distance $d_E$, on which we put the Borel $\sigma$-algebra.

The main result is Theorem~\ref{thm:countable_set_bound}.
Under an assumption on the covering number of $T$, for a process $X$ that satisfies the Kolmogorov condition $\mathbb{E}[d_E(X_s, X_t)^p] \le M d_T(s, t)^q$ (see Definition~\ref{def:IsKolmogorovProcess}),the theorem gives a finite bound on the expectation of the supremum of the ratio
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in T'} \frac{d_E(X_s, X_t)^p}{d_T(s, t)^{\beta p}} \right]
  \: ,
\end{align*}
for $T'$ a countable subset of $T$.
As a corollary, we obtain that there exists a modification of $X$ with HÃ¶lder continuous paths.

In Lean, we will use the typeclass \texttt{PseudoEMetricSpace} for both $T$ and $E$ as long as possible, and then specialize to \texttt{EMetricSpace} (or perhaps even \texttt{MetricSpace}) when we need the stronger properties of a metric space.
For example, to prove the existence of a modification of a stochastic process, we will eventually use the fact that $d_E(x, y) = 0$ implies $x = y$, which does not hold in a pseudo-metric space.
All distances will be expressed with \texttt{edist}, which takes values in \texttt{ENNReal}, and the integrals refer to Lebesgue integrals.

\section{Covers and covering numbers}

Let $(E, d_E)$ be a pseudo-metric space.

\begin{definition}[$\varepsilon$-cover]\label{def:IsCover}
  \leanok
  \lean{IsCover}
  A set $C \subseteq E$ is an $\varepsilon$-cover of a set $A \subseteq E$ if for every $x \in A$, there exists $y \in C$ such that $d_E(x, y) \le \varepsilon$.
\end{definition}


\begin{definition}[External covering number]\label{def:externalCoveringNumber}
  \uses{def:IsCover}
  \leanok
  \lean{externalCoveringNumber}
  The external covering number of a set $A \subseteq E$ for $\varepsilon \ge 0$ is the smallest cardinality of an $\varepsilon$-cover of $A$.
  Denote it by $N^{ext}_\varepsilon(A)$.
\end{definition}


\begin{definition}[Internal covering number]\label{def:internalCoveringNumber}
  \uses{def:IsCover}
  \leanok
  \lean{internalCoveringNumber}
  The internal covering number of a set $A \subseteq E$ for $\varepsilon \ge 0$ is the smallest cardinality of an $\varepsilon$-cover of $A$ which is a subset of $A$.
  Denote it by $N^{int}_\varepsilon(A)$.
\end{definition}


\begin{definition}[Separated set]\label{def:IsSeparated}
  \mathlibok
  \lean{Metric.IsSeparated}
A set $c \subseteq E$ is $\varepsilon$-separated if for all $x, y \in c$, $d_E(x, y) > \varepsilon$.
\end{definition}


\begin{definition}[Packing number]\label{def:packingNumber}
  \uses{def:IsSeparated}
  \leanok
  \lean{packingNumber}
The packing number of a set $A \subseteq E$ for $\varepsilon > 0$ is the largest cardinality of an $\varepsilon$-separated subset of $A$.
Denote it by $P_\varepsilon(A)$.
\end{definition}


\begin{lemma}\label{lem:externalCoveringNumber_le_internalCoveringNumber}
  \uses{def:externalCoveringNumber, def:internalCoveringNumber}
  \leanok
  \lean{externalCoveringNumber_le_internalCoveringNumber}
$N^{ext}_\varepsilon(A) \le N^{int}_\varepsilon(A)$.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{lemma}\label{lem:internalCoveringNumber_le_packingNumber}
  \uses{def:internalCoveringNumber, def:packingNumber}
  \leanok
  \lean{internalCoveringNumber_le_packingNumber}
$N^{int}_\varepsilon(A) \le P_\varepsilon(A)$.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{lemma}\label{lem:packingNumber_two_le_externalCoveringNumber}
  \uses{def:packingNumber, def:externalCoveringNumber}
  \leanok
  \lean{packingNumber_two_le_externalCoveringNumber}
$P_{2\varepsilon}(A) \le N^{ext}_\varepsilon(A)$.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{lemma}\label{lem:internalCoveringNumber_eq_one_of_diam_le}
  \uses{def:internalCoveringNumber}
  \leanok
  \lean{internalCoveringNumber_eq_one_of_diam_le}
If $\mathrm{diam}(A) \le \varepsilon$ and $A$ is nonempty, then $N^{int}_\varepsilon(A) = 1$.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{lemma}\label{lem:cover_eq_of_lt_iInf_dist}
  \uses{def:IsCover}
  \leanok
  \lean{cover_eq_of_lt_iInf_edist}
Let $C$ be a $\varepsilon$-cover of a $J$ with $C \subseteq J$.
If $\varepsilon < \inf_{s, t \in J; s \ne t} d_T(s, t)$ then $C = J$.
\end{lemma}

\begin{proof}
Let $s \in J$. Since $C$ is an $\varepsilon$-cover of $J$, there exists $t \in C$ such that $d_T(s, t) \le \varepsilon$.
Since $\varepsilon < \inf_{s, t \in J; s \ne t}d_T(s, t)$, we have $s = t$.
Thus, $s \in C$.
Since $s$ was arbitrary, we have $J \subseteq C$.
And by assumption $C \subseteq J$.
\end{proof}


\subsection{Covering number and volume}

In this section $E$ is a finite dimensional inner product space, with dimension $d$.

\begin{lemma}\label{lem:volume_le_of_isCover}
  \uses{def:IsCover}
  \leanok
  \lean{volume_le_of_isCover}
Let $A \subseteq E$ and $C \subseteq E$ be a finite $\varepsilon$-cover of $A$. Denote by $V(A)$ the volume of $A$.
Then $V(A) \le \vert C \vert V(B_\varepsilon)$, in which $B_\varepsilon$ is the closed ball of radius $\varepsilon$ in $E$.
\end{lemma}

\begin{proof}
Since $C$ is a cover of $A$, $A$ is a subset of the union of the closed balls $B_\varepsilon(c)$ for $c \in C$. Then
\begin{align*}
  V(A) \le V(\bigcup_{c \in C} B_\varepsilon(c))
  &\le \sum_{c \in C} V(B_\varepsilon(c))
  = \vert C \vert V(B_\varepsilon)
  \: .
\end{align*}
\end{proof}

The volume of $B_\varepsilon$ is given by the following formula (see \href{https://leanprover-community.github.io/mathlib4_docs/Mathlib/MeasureTheory/Measure/Lebesgue/VolumeOfBalls.html#InnerProductSpace.volume_closedBall}{InnerProductSpace.volume\_closedBall}).
\begin{align*}
  V(B_\varepsilon) = \frac{\pi^{d/2}}{\Gamma(d/2 + 1)} \varepsilon^d
  \: .
\end{align*}


\begin{lemma}\label{lem:volume_le_externalCoveringNumber_mul}
  \uses{def:externalCoveringNumber}
  \leanok
  \lean{volume_le_externalCoveringNumber_mul}
$V(A) \le N^{ext}_\varepsilon(A) V(B_\varepsilon)$.
\end{lemma}

\begin{proof}
  \uses{lem:volume_le_of_isCover}
Use Lemma~\ref{lem:volume_le_of_isCover} with a cover of minimal cardinal.
\end{proof}


\begin{lemma}\label{lem:le_volume_of_isSeparated}
  \uses{def:IsSeparated}
  \leanok
  \lean{le_volume_of_isSeparated}
Let $A \subseteq E$ and let $S \subseteq A$ be an $\varepsilon$-separated set.
Then $\vert S \vert V(B_{\varepsilon/2}) \le V(A + B_{\varepsilon/2})$.
\end{lemma}

\begin{proof}
Since $S$ is $\varepsilon$-separated, the closed balls $B_{\varepsilon/2}(s)$ for $s \in S$ are pairwise disjoint.
Furthermore, these balls are contained in $A + B_{\varepsilon/2}$.
Thus, we have
\begin{align*}
  \vert S \vert V(B_{\varepsilon/2})
  &= \sum_{s \in S} V(B_{\varepsilon/2}(s))
  = V(\bigcup_{s \in S} B_{\varepsilon/2}(s))
  \le V(A + B_{\varepsilon/2})
  \: .
\end{align*}
\end{proof}


\begin{lemma}\label{lem:packingNumber_mul_le_volume}
  \uses{def:packingNumber}
  \leanok
  \lean{packingNumber_mul_le_volume}
$P_\varepsilon(A) V(B_{\varepsilon/2}) \le V(A + B_{\varepsilon/2})$.
\end{lemma}

\begin{proof}
  \uses{lem:le_volume_of_isSeparated}
Use Lemma~\ref{lem:le_volume_of_isSeparated} with $S$ an $\varepsilon$-separated set of maximal cardinality.
\end{proof}


\begin{lemma}\label{lem:volume_div_le_internalCoveringNumber}
  \uses{def:internalCoveringNumber}
  \leanok
  \lean{volume_div_le_internalCoveringNumber}
$\frac{V(A)}{V(B_\varepsilon)} \le N^{int}_\varepsilon(A)$.
\end{lemma}

\begin{proof}
  \uses{lem:volume_le_externalCoveringNumber_mul, lem:externalCoveringNumber_le_internalCoveringNumber}
We have $\frac{V(A)}{V(B_\varepsilon)} \le N^{ext}_\varepsilon(A)$ by Lemma~\ref{lem:volume_le_externalCoveringNumber_mul} and $N^{ext}_\varepsilon(A) \le N^{int}_\varepsilon(A)$ by Lemma~\ref{lem:externalCoveringNumber_le_internalCoveringNumber}.
\end{proof}


\begin{lemma}\label{lem:internalCoveringNumber_le_volume_div}
  \uses{def:internalCoveringNumber}
  \leanok
  \lean{internalCoveringNumber_le_volume_div}
$N^{int}_\varepsilon(A) \le \frac{V(A + B_{\varepsilon/2})}{V(B_{\varepsilon/2})}$.
\end{lemma}

\begin{proof}
  \uses{lem:packingNumber_mul_le_volume, lem:internalCoveringNumber_le_packingNumber}
We have $N^{int}_\varepsilon(A) \le P_\varepsilon(A)$ by Lemma~\ref{lem:internalCoveringNumber_le_packingNumber} and $P_\varepsilon(A) \le \frac{V(A + B_{\varepsilon/2})}{V(B_{\varepsilon/2})}$ by Lemma~\ref{lem:packingNumber_mul_le_volume}.
\end{proof}


\begin{lemma}\label{lem:internalCoveringNumber_closedBall_ge}
  \uses{def:internalCoveringNumber}
  \leanok
  \lean{internalCoveringNumber_closedBall_ge}
$N_\varepsilon^{int}(B_1) \ge \frac{1}{\varepsilon^d}$.
\end{lemma}

\begin{proof}
  \uses{lem:volume_div_le_internalCoveringNumber}
By Lemma~\ref{lem:volume_div_le_internalCoveringNumber},
\begin{align*}
  N^{int}_\varepsilon(B_1)
  &\ge \frac{V(B_1)}{V(B_\varepsilon)}
  = \frac{1}{\varepsilon^d}
  \: .
\end{align*}

\end{proof}


\begin{lemma}\label{lem:internalCoveringNumber_closedBall_le}
  \uses{def:internalCoveringNumber}
  \leanok
  \lean{internalCoveringNumber_closedBall_le}
$N_\varepsilon^{int}(B_1) \le \left(\frac{2}{\varepsilon} + 1\right)^d$.
\end{lemma}

\begin{proof}
  \uses{lem:internalCoveringNumber_le_volume_div}
By Lemma~\ref{lem:internalCoveringNumber_le_volume_div},
\begin{align*}
  N^{int}_\varepsilon(B_1)
  &\le \frac{V(B_1 + B_{\varepsilon/2})}{V(B_{\varepsilon/2})}
  = \frac{V(B_{1 + \varepsilon/2})}{V(B_{\varepsilon/2})}
  = \frac{(1 + \varepsilon/2)^d}{(\varepsilon/2)^d}
  \: .
\end{align*}
\end{proof}


\subsection{Bounded internal covering number}

\begin{definition}[Bounded internal covering number]\label{def:HasBoundedInternalCoveringNumber}
  \uses{def:internalCoveringNumber}
  \leanok
  \lean{HasBoundedInternalCoveringNumber}
  Let $\mathrm{diam}(A)$ be the diameter of $A \subseteq E$, i.e. $\mathrm{diam}(A) = \sup_{x,y \in A} d_E(x, y)$.
  A set $A \subseteq E$ has bounded internal covering number with constant $c>0$ and exponent $t>0$ if for all $\varepsilon \in (0, \mathrm{diam}(A)]$, $N^{int}_\varepsilon(A) \le c \varepsilon^{-t}$.
\end{definition}


\begin{lemma}\label{lem:hasBoundedInternalCoveringNumber_unitInterval}
  \uses{def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{internalCoveringNumber_Icc_zero_one_le_one_div}
The unit interval $I = [0, 1] \subseteq \mathbb{R}$ has bounded internal covering number with constant $1$ and exponent $1$: for $\varepsilon \le 1$, $N^{int}_\varepsilon(I) \le 1/\varepsilon$.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\section{Chaining}

\subsection{Chaining sequence}


\begin{definition}\label{def:nearestPt}
  \leanok
  \lean{nearestPt}
Let $S$ be a finite set of $E$ and $x \in E$.
We denote by $\pi(x, S)$ the point in $S$ which is closest to $x$, i.e. a point such that $d_E(x, S) = \min_{y \in S} d_E(x, y)$ (chosen arbitrarily among the minima if there are several).
\end{definition}


\begin{lemma}\label{lem:dist_nearestPt_le}
  \uses{def:nearestPt}
  \leanok
  \lean{edist_nearestPt_le}
Let $S$ be a finite set of $E$ and $x \in E$.
Then for all $y \in S$, $d_E(x, \pi(x, S)) \le d_E(x, y)$.
\end{lemma}

\begin{proof}\leanok
By definition.
\end{proof}


\begin{lemma}\label{lem:dist_nearestPt_of_isCover}
  \uses{def:nearestPt, def:IsCover}
  \leanok
  \lean{edist_nearestPt_of_isCover}
Let $C_\varepsilon$ be a finite $\varepsilon$-cover of $A \subseteq E$ (assuming such a finite cover exists).
Then for all $x \in A$, $d_E(x, \pi(x, C_\varepsilon)) \le \varepsilon$.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{definition}[Chaining sequence]\label{def:chainingSequence}
  \uses{def:nearestPt, def:IsCover}
  \leanok
  \lean{chainingSequence}
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers, $C_n$ a finite $\varepsilon_n$-cover of $A \subseteq E$ with $C_n \subseteq A$ and $x \in C_k$ for some $k \in \mathbb{N}$.
We define the chaining sequence of $x$, denoted $(\bar{x}_i)_{i \le k}$, recursively as follows: $\bar{x}_k = x$ and for $i < k$, $\bar{x}_i = \pi(\bar{x}_{i+1}, C_i)$.
\end{definition}


\begin{lemma}\label{lem:chainingSequence_mem}
  \uses{def:chainingSequence}
  \leanok
  \lean{chainingSequence_mem}
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers, $C_n$ a finite $\varepsilon_n$-cover of $A \subseteq E$ with $C_n \subseteq A$ and $x \in C_k$ for some $k \in \mathbb{N}$.
Then for all $i \le k$, $\bar{x}_i\in C_i$.
\end{lemma}

\begin{proof}\leanok
By definition.
\end{proof}


\begin{lemma}\label{lem:dist_chainingSequence_add_one}
  \uses{def:chainingSequence}
  \leanok
  \lean{edist_chainingSequence_add_one}
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers, $C_n$ a finite $\varepsilon_n$-cover of $A \subseteq E$ with $C_n \subseteq A$ and $x \in C_k$ for some $k \in \mathbb{N}$.
Then for all $i < k$, $d_E(\bar{x}_i, \bar{x}_{i+1}) \le \varepsilon_i$.
\end{lemma}

\begin{proof}\leanok
  \uses{lem:dist_nearestPt_of_isCover, lem:chainingSequence_mem}
Apply Lemma~\ref{lem:dist_nearestPt_of_isCover} with $S = C_i$ and $x = \bar{x}_{i+1}$.
\end{proof}


\begin{lemma}\label{lem:dist_chainingSequence_le_sum}
  \uses{def:chainingSequence}
  \leanok
  \lean{edist_chainingSequence_le_sum}
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers, $C_n$ a finite $\varepsilon_n$-cover of $A \subseteq E$ with $C_n \subseteq A$ and $x \in C_k$ for some $k \in \mathbb{N}$.
Then for $m \le k$, $d_E(\bar{x}_m, x) \le \sum_{i=m}^{k-1} \varepsilon_i$.
\end{lemma}

\begin{proof}\leanok
  \uses{lem:dist_chainingSequence_add_one}
By the triangle inequality and Lemma~\ref{lem:dist_chainingSequence_add_one},
\begin{align*}
  d_E(\bar{x}_m, x)
  \le \sum_{i=m}^{k-1} d_E(\bar{x}_i, \bar{x}_{i+1})
  \le \sum_{i=m}^{k-1} \varepsilon_i
  \: .
\end{align*}
\end{proof}


\begin{lemma}\label{lem:dist_chainingSequence_le}
  \uses{def:chainingSequence}
  \leanok
  \lean{edist_chainingSequence_le}
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers, $C_n$ a finite $\varepsilon_n$-cover of $A \subseteq E$ with $C_n \subseteq A$.
Let $m, k, \ell \in \mathbb{N}$ with $m \le k$ and $m \le \ell$ and let $x \in C_k$ and $y \in C_\ell$.
Then
\begin{align*}
  d_E(\bar{x}_m, \bar{y}_m)
  &\le d_E(x, y) + \sum_{i=m}^{k-1} \varepsilon_i + \sum_{j=m}^{\ell-1} \varepsilon_j
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:dist_chainingSequence_le_sum}
Triangle inequality and Lemma~\ref{lem:dist_chainingSequence_le_sum}.
\end{proof}


\begin{corollary}\label{cor:dist_chainingSequence_pow_two_le}
  \uses{def:chainingSequence}
  \leanok
  \lean{edist_chainingSequence_pow_two_le}
For $\varepsilon_n = \varepsilon_0 2^{-n}$, with the hypothesis of Lemma~\ref{lem:dist_chainingSequence_le}, we have
\begin{align*}
  d_E(\bar{x}_m, \bar{y}_m)
  &\le d_E(x, y) + \varepsilon_0 2^{-m+2}
  \: .
\end{align*}
\end{corollary}

\begin{proof}\leanok
  \uses{lem:dist_chainingSequence_le}

\end{proof}


\subsection{A subset of pairs}

We will be interested in bounding expressions of the form $\sup_{s,t\in J, d_T(s,t) \le c} d_E(f(s), f(t))$ for a finite set $J$ and some function $f : T \to E$.
This is a supremum over pairs in $J$ and there could be $\vert J \vert^2$ such pairs.
We will build a subset $K$ of $J^2$ which is much smaller, of size linear in $\vert J \vert$, such that its points are not too far apart and
\begin{align*}
  \sup_{s,t\in J, d_T(s,t) \le c} d_E(f(s), f(t))
  & \le 2 \sup_{(s,t) \in K} d_E(f(s), f(t))
  \: .
\end{align*}
The pairs $(s, t) \in K$ will still be close together, in the sense that $d_T(s, t) \le c n$ for some $n$ that is logarithmic in the size of $J$.

For $t \in V \subseteq T$ and $u\ge 0$, we denote by $B_V(t, u)$ the closed ball with center $t$ and radius $u$ in $V$.
That is, $B_V(t, u) = \{s \in V \mid d_T(s, t) \le u\}$.

We want to cover $J$ with balls that have radius logarithmic in the number of points of the ball.

\begin{definition}\label{def:logSizeRadius}
  \leanok
  \lean{logSizeRadius}
Let $V$ be a finite subset of a metric space and let $t \in V$ and $a > 1$, $c > 0$.
Let the \emph{log-size radius} of $t$ in $V$, denoted by $r_{V,t}$, be the smallest positive integer $r$ such that $\vert B_V(t, r c) \vert \le a^{r}$.
\end{definition}


\begin{lemma}\label{lem:card_logSizeRadius_ge}
  \uses{def:logSizeRadius}
  \leanok
  \lean{card_le_logSizeRadius_ge}
$a^{r_{V,t}-1} \le \vert B_V(t, (r_{V,t}-1)c) \vert$~.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{lemma}\label{lem:card_logSizeRadius_le}
  \uses{def:logSizeRadius}
  \leanok
  \lean{card_le_logSizeRadius_le}
$\vert B_V(t, r_{V,t}c) \vert \le a^{r_{V,t}}$~.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{definition}[Log-size ball sequence]\label{def:logSizeBallSequence}
  \uses{def:logSizeRadius}
  \leanok
  \lean{logSizeBallSeq}
Let $(T,d_T)$ be a metric space and let $J \subseteq T$ be finite, $a,c \in \mathbb R_+$ with $a \ge 1$ and $n \in \{1, 2, ...\}$ such that $|J| \le a^n$.
An log-size ball sequence for $(J, a, c, n)$ is a sequence of $(V_i, t_i, r_i)_{i \in \mathbb{N}}$ such that
\begin{itemize}
  \item $V_0 = J$, $t_0$ is an arbitrary point in $J$,
  \item for all $i$, $r_i$ is the log-size radius of $t_i$ in $V_i$,
  \item $V_{i+1} = V_i \setminus B_{V_i}(t_i, (r_i - 1)c)$, $t_{i+1}$ is arbitrarily chosen in $V_{i+1}$.
\end{itemize}
\end{definition}

A log-size ball sequence gives a partition of $J$ into sets which are contained in balls of radius $(r_i - 1)c$ around $t_i$, and satisfy cardinality constraints.


\begin{lemma}\label{lem:logSizeRadius_logSizeBallSequence_le}
  \uses{def:logSizeBallSequence}
  \leanok
  \lean{radius_logSizeBallSeq_le}
The radius of a log-size ball sequence $(V_i, t_i, r_i)_{i \in \mathbb{N}}$ for $(J, a, c, n)$ satisfies $r_i \le n$ for all $i \in \mathbb{N}$.
\end{lemma}

\begin{proof}
\leanok
Since $|J| \le a^n$, we have $\vert B_{V_i}(t_i, n c) \vert \le \vert J \vert \le a^{n}$.
\end{proof}


\begin{lemma}\label{lem:logSizeBallSequence_V_anti}
  \uses{def:logSizeBallSequence}
  \leanok
  \lean{finset_logSizeBallSeq_add_one_subset}
The sets $V_i$ of a log-size ball sequence $(V_i, t_i, r_i)_{i \in \mathbb{N}}$ are a decreasing sequence of sets. That is, $V_{i+1} \subseteq V_i$ for all $i \in \mathbb{N}$.
\end{lemma}

\begin{proof}
\leanok
$V_{i+1} = V_i \setminus B_{V_i}(t_i, (r_i - 1)c)$ hence $V_{i+1} \subseteq V_i$.
\end{proof}


\begin{lemma}\label{lem:logSizeBallSequence_eq_zero}
  \uses{def:logSizeBallSequence}
  \leanok
  \lean{card_finset_logSizeBallSeq_card_eq_zero}
For any log-size ball sequence $(V_i, t_i, r_i)_{i \in \mathbb{N}}$ for $(J, a, c, n)$, for all $k \ge \vert J \vert$, $V_k = \emptyset$.
\end{lemma}

\begin{proof}
  \leanok
  \uses{lem:logSizeBallSequence_V_anti}
$V_{i+1} = V_i \setminus B_{V_i}(t_i, (r_i - 1)c)$ and since $t_i \in B_{V_i}(t_i, (r_i - 1)c)$, we have $\vert V_{i+1} \vert < \vert V_i \vert$ and the cardinal eventually reaches $0$, in at most $\vert J \vert$ steps.
\end{proof}


\begin{lemma}\label{lem:logSizeBallSequence_disjoint_B}
  \uses{def:logSizeBallSequence}
  \leanok
  \lean{disjoint_smallBall_logSizeBallSeq}
For $i \ne j$, the balls $B_{V_i}(t, (r_i-1)c)$ and $B_{V_j}(t_j, (r_j-1)c)$ of a log-size ball sequence $(V_i, t_i, r_i)_{i \in \mathbb{N}}$ are disjoint.
\end{lemma}

\begin{proof}
  \leanok
  \uses{lem:logSizeBallSequence_V_anti}
Assume w.l.o.g. that $i < j$.
Then $B_{V_j}(t_j, (r_j-1)c) \subseteq V_j \subseteq V_{i+1}$.
It suffices to show that $B_{V_i}(t_i, (r_i-1)c)$ and $V_{i+1}$ are disjoint.
This follows from the definition of $V_{i+1} = V_i \setminus B_{V_i}(t_i, (r_i-1)c)$.
\end{proof}


\begin{definition}\label{def:pairSet}
  \uses{def:logSizeBallSequence}
  \leanok
  \lean{pairSet}
Let $(V_i, t_i, r_i)_{i \in \mathbb{N}}$ be a log-size ball sequence for $(J, a, c, n)$.
For $i \in \mathbb{N}$, let $K_i = \{t_i\} \times B_{V_i}(t_i, r_i c)$ be the set of pairs $(t_i, s)$ for $s$ in the ball $B_{V_i}(t_i, r_i c)$.
We define $K = \bigcup_{i=0}^{\vert J \vert-1} K_i$, set of all pairs from the log-size ball sequence.
\end{definition}


\begin{lemma}\label{lem:card_pairSet_le}
  \uses{def:pairSet}
  \leanok
  \lean{card_pairSet_le}
The cardinal of the pair set $K$ of a log-size ball sequence for $(J, a, c, n)$ satisfies $|K| \le a |J|$.
\end{lemma}

\begin{proof}
  \leanok
  \uses{lem:card_logSizeRadius_ge, lem:card_logSizeRadius_le, lem:logSizeBallSequence_disjoint_B}
Using Lemma~\ref{lem:card_logSizeRadius_le}, the cardinal of $K$ is bounded by
\begin{align*}
  \vert K \vert
  &\le \sum_{i=0}^{m-1} \vert K_i \vert
  \le \sum_{i=0}^{m-1} a^{r_i}
  \: .
\end{align*}
Since the sets $B_{V_i}(t_i, (r_i-1)c)$ are disjoint by Lemma~\ref{lem:logSizeBallSequence_disjoint_B}, we can use Lemma~\ref{lem:card_logSizeRadius_ge} to get
\begin{align*}
  \sum_{i=0}^{m-1} a^{r_i - 1}
  \le \sum_{i=0}^{m-1} \vert B_{V_i}(t_i, (r_i-1)c) \vert
  = \left\vert \bigcup_{i=0}^{m-1} B_{V_i}(t_i, (r_i-1)c) \right\vert
  \le \vert J \vert
  \: .
\end{align*}
We obtained the inequality $\vert K \vert \le a \vert J \vert$
\end{proof}


\begin{lemma}\label{lem:dist_le_of_mem_pairSet}
  \uses{def:pairSet}
  \leanok
  \lean{edist_le_of_mem_pairSet}
Let $(s, t)$ be a pair in the pair set $K$ of a log-size ball sequence for $(J, a, c, n)$.
Then $d_T(s, t) \le c n$.
\end{lemma}

\begin{proof}
  \leanok
  \uses{lem:logSizeRadius_logSizeBallSequence_le}
A pair $(t, s) \in K$ is of the form $(t_i, s)$ for $s \in B_V(t_i, r_i c)$ and satisfies
\begin{align*}
  d_T(t_i, s) \le c r_i \le c n \: .
\end{align*}
The last inequality is from Lemma~\ref{lem:logSizeRadius_logSizeBallSequence_le}.
\end{proof}


\begin{lemma}\label{lem:sup_dist_le_two_mul_sup_dist_pairSet}
  \uses{def:pairSet}
  \leanok
  \lean{iSup_edist_pairSet}
Let $K$ be the pair set of a log-size ball sequence $(V_i, t_i, r_i)_{i \in \mathbb{N}}$ for $(J, a, c, n)$.
Then for any function $f : T \to E$ with $(E,d_E)$ a metric space,
\begin{align*}
  \sup_{s,t\in J, d_T(s,t) \le c} d_E(f(s), f(t))
  & \le 2 \sup_{(s,t) \in K} d_E(f(s), f(t))
  \: .
\end{align*}
\end{lemma}

\begin{proof}
\leanok
Let $(s, t) \in J^2$ such that $d_T(s, t) \le c$.
Then there exists a largest $\ell \in \mathbb{N}$ such that $s, t \in V_\ell$.
Assume w.l.o.g. that $s \notin V_{\ell + 1}$. Then $s \in B_{V_\ell}(t_\ell, (r_\ell-1)c)$ (since $V_{\ell + 1} = V_\ell \setminus B_{V_\ell}(t_\ell, (r_\ell-1)c)$), which implies $d_T(s, t_\ell) \le (r_\ell - 1)c$.

Since $d_T(s, t) \le c$, $d_T(t, t_\ell) \le d_T(t, s) + d_T(s, t_\ell) \le r_\ell c$, hence $t \in B_{V_\ell}(t_\ell, r_\ell c)$ and we have that both $s$ and $t$ are in $B_{V_\ell}(t_\ell, r_\ell c)$.
Thus both $(t_\ell, s)$ and $(t_\ell, t)$ are in $K_\ell \subseteq K$.
Finally
\begin{align*}
  d_E(f(s), f(t))
  &\le d_E(f(s), f(t_\ell)) + d_E(f(t_\ell), f(t))
  \\
  &\le 2\sup_{(s',t') \in K} d_E(f(s'), f(t'))
  \: .
\end{align*}
\end{proof}


\begin{lemma}\label{lem:pair_reduction}
  \uses{def:pairSet}
  \leanok
  \lean{pair_reduction}
Let $(T,d_T)$ be a metric space.
Let $J \subseteq T$ be finite, $a > 1$, $c>0$ and $n \in \{1, 2, ...\}$ such that $|J| \le a^n$.
Then, there is $K \subseteq J^2$ such that for any function $f : T \to E$ with $(E,d_E)$ a metric space,
\begin{align}
  |K|
  & \le a |J|
  \:, \label{eq:chain1} \\
  \forall (s,t) \in K,
  &\:  d_T(s,t) \le c n
  \:, \label{eq:chain2} \\
  \sup_{s,t\in J, d_T(s,t) \le c} d_E(f(s), f(t))
  & \le 2 \sup_{(s,t) \in K} d_E(f(s), f(t))
  \: . \label{eq:chain3}
\end{align}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:card_pairSet_le, lem:dist_le_of_mem_pairSet, lem:sup_dist_le_two_mul_sup_dist_pairSet}
Let $(V_i, t_i, r_i)_{i \in \mathbb{N}}$ be a log-size ball sequence for $(J, a, c, n)$. We show that its pair set satisfies the conditions of the lemma.

Equation~\eqref{eq:chain1} is given by Lemma~\ref{lem:card_pairSet_le}.
The second property~\eqref{eq:chain2} is Lemma~\ref{lem:dist_le_of_mem_pairSet}.
Equation~\eqref{eq:chain3} was proved in Lemma~\ref{lem:sup_dist_le_two_mul_sup_dist_pairSet}.
\end{proof}





\section{Chaining for stochastic processes under Kolmogorov conditions}

\subsection{Kolmogorov condition}

\begin{definition}[Kolmogorov condition]\label{def:IsKolmogorovProcess}
  \leanok
  \lean{ProbabilityTheory.IsKolmogorovProcess}
Let $X : T \to \Omega \to E$ be a stochastic process, where $(T, d_T)$ and $(E, d_E)$ are pseudo-metric spaces and $(\Omega, \mathbb{P})$ is a measure space.
Let $p, q > 0$.
We say that $X$ satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$ if for all $s, t \in T$, $(X_s, X_t)$ is $\mathbb{P}$-a.e. measurable for the Borel $\sigma$-algebra on $E^2$ and
\begin{align*}
  \mathbb{E}[d_E(X_s, X_t)^p] \le M d_T(s, t)^q
  \: .
\end{align*}
\end{definition}

Remark: the measurability condition on the pair would be implied by the measurability of $X_t$ for all $t \in T$ if we assumed that $E$ is separable (\texttt{SecondCountableTopology} in Lean), which implies that the Borel $\sigma$-algebra on the product is equal to the product of the Borel $\sigma$-algebras.
We follow \cite{kratschmer2023kolmogorov} and do not require separability.


\begin{lemma}\label{lem:IsKolmogorovProcess.edist_eq_zero}
  \uses{def:IsKolmogorovProcess}
  \leanok
  \lean{ProbabilityTheory.IsKolmogorovProcess.edist_eq_zero}
If $X : T \to \Omega \to E$ is a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$ and $s, t \in T$ are such that $d_T(s, t) = 0$, then $\mathbb{P}$-a.e. $d_E(X_s, X_t) = 0$.
\end{lemma}

\begin{proof}\leanok
It suffices to show that $d_E(X_s, X_t)^p = 0$ almost everywhere, which is in turn implied by $\mathbb{E}[d_E(X_s, X_t)^p] \le M d_t(s, t)^q = 0$.
\end{proof}


\begin{lemma}\label{lem:IsKolmogorovProcess.lintegral_sup_rpow_edist_eq_zero}
  \uses{def:IsKolmogorovProcess}
  \leanok
  \lean{ProbabilityTheory.IsKolmogorovProcess.lintegral_sup_rpow_edist_eq_zero}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
Let $T'$ be a countable subset of $T$ such that for all $s, t \in T'$, $d_T(s, t) = 0$.
Then
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in T'} d_E(X_s, X_t)^p \right]
  &= 0
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:IsKolmogorovProcess.edist_eq_zero}
Since $T'$ is countable, we get from Lemma~\ref{lem:IsKolmogorovProcess.edist_eq_zero} that almost surely, for all $s, t \in T'$, $d_E(X_s, X_t)^p = 0$.
In particular the expectation of the supremum is $0$.
\end{proof}


\paragraph{Measurability}

\begin{lemma}\label{lem:IsKolmogorovProcess.aemeasurable}
  \uses{def:IsKolmogorovProcess}
  \leanok
  \lean{ProbabilityTheory.IsKolmogorovProcess.aemeasurable}
If $X : T \to \Omega \to E$ is a function that satisfies the Kolmogorov condition, then for all $t \in T$, $X_t$ is $\mathbb{P}$-a.e. measurable.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{lemma}\label{lem:aemeasurable_pair_of_aemeasurable}
  \leanok
  \lean{ProbabilityTheory.aemeasurable_pair_of_aemeasurable}
If $E$ is separable and $X : T \to \Omega \to E$ is a process such that $X_t$ is $\mathbb{P}$-a.e. measurable for all $t \in T$, then for all $s, t \in T$, the pair $(X_s, X_t)$ is $\mathbb{P}$-a.e. measurable for the Borel $\sigma$-algebra on $E^2$.
\end{lemma}

\begin{proof}\leanok

\end{proof}


\begin{lemma}\label{lem:IsKolmogorovProcess.aemeasurable_edist}
  \uses{def:IsKolmogorovProcess}
  \leanok
  \lean{ProbabilityTheory.IsKolmogorovProcess.aemeasurable_edist}
If $X : T \to \Omega \to E$ is a process that satisfies the Kolmogorov condition, then for all $s,t \in T$ the function $\omega \mapsto d_E(X_s(\omega), X_t(\omega))$ is $\mathbb{P}$-a.e. measurable.
\end{lemma}

\begin{proof}\leanok

\end{proof}

\paragraph{Distance bounds}

\begin{lemma}\label{lem:integral_sup_rpow_dist_le_card_mul_rpow}
  \uses{def:IsKolmogorovProcess}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_le_card_mul_rpow}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
Let $\varepsilon > 0$ and $C \subseteq T^2$ be a finite set such that for all $(s, t) \in C$, $d_T(s, t) \le \varepsilon$.
Then
\begin{align*}
  \mathbb{E}\left[\sup_{(s,t) \in C} d_E(X_s, X_t)^p \right]
  &\le \vert C \vert M \varepsilon^q
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{def:IsKolmogorovProcess}
\begin{align*}
  \mathbb{E}\left[\sup_{(s,t) \in C} d_E(X_s, X_t)^p \right]
  &\le \mathbb{E}\left[\sum_{(s,t) \in C} d_E(X_s, X_t)^p \right]
  \\
  &\le M \sum_{(s,t) \in C} d_T(s, t)^q
  \\
  &\le \vert C \vert M \varepsilon^q
  \: .
\end{align*}
\end{proof}


\begin{lemma}\label{lem:integral_sup_rpow_dist_of_dist_le}
  \uses{def:IsKolmogorovProcess}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_le_card_mul_rpow_of_dist_le}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
Let $J \subseteq T$ be finite, $a, c \in \mathbb R_+$ with $a \ge 1$ and $n \in \{1, 2, ...\}$ such that $|J| \le a^n$.
Then
\begin{align*}
  \mathbb{E} \left[ \sup_{s, t \in J; d_T(s, t) \le c} d_E(X_s, X_t)^p \right]
  &\le 2^p a |J| M (cn)^q
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:pair_reduction, lem:integral_sup_rpow_dist_le_card_mul_rpow}
By Lemma~\ref{lem:pair_reduction}, there exists $K \subseteq J^2$ such that
\begin{align*}
  |K|
  & \le a |J|
  \:, \\
  \forall (s,t) \in K,
  & \ d_T(s,t) \le c n
  \:, \\
  \sup_{s,t\in J, d_T(s,t) \le c} d_E(X_s, X_t)
  & \le 2 \sup_{(s,t) \in K} d_E(X_s, X_t)
  \: .
\end{align*}
Hence for such a set $K$,
\begin{align*}
  \mathbb{E} \left[ \sup_{s, t \in J; d_T(s, t) \le c} d_E(X_s, X_t)^p \right]
  &\le 2^p \mathbb{E} \left[ \sup_{(s, t) \in K} d_E(X_s, X_t)^p \right]
  \: .
\end{align*}
Then by Lemma~\ref{lem:integral_sup_rpow_dist_le_card_mul_rpow},
\begin{align*}
  \mathbb{E} \left[ \sup_{(s, t) \in K} d_E(X_s, X_t)^p \right]
  &\le |K| M (cn)^q
  \le a |J| M (cn)^q
  \: .
\end{align*}
\end{proof}


\subsection{Bound for a set of points that are close together}

For a finite index set $T$, we want to obtain a bound on
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in T; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right] \: .
\end{align*}
Note the condition that the supremum is taken over pairs $(s, t)$ such that $d_T(s, t) \le \delta$.

We consider covers of $T$ at different scales. $C_n$ is a finite $\varepsilon_n$-cover of $T$ with $\varepsilon_n = \varepsilon_0 2^{-n}$.
$T$ is equal to $C_k$ for some $k$ large enough, so the supremum over $T$ is a supremum at that scale $k$.
We will change scale to some $m \le k$ that depends on the distance bound $\delta$ ($m$ is of order $\log_2 \delta$) and consider the supremum over $C_m$ (plus a term due to the scale change).
Then for the supremum over a set in $C_m$, we use the reduction in the number of pairs of Lemma~\ref{lem:pair_reduction}.

\begin{lemma}\label{lem:scale_change}
  \uses{def:chainingSequence}
  \leanok
  \lean{scale_change}
Let $X : T \to E$.
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers, $C_n$ a finite $\varepsilon_n$-cover of $J \subseteq T$ with $C_n \subseteq J$.
For $m \le k$,
\begin{align*}
  \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_s, X_t)
  &\le \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_{\bar{s}_m}, X_{\bar{t}_m})
    + 2 \sup_{s \in C_k} d_E(X_s, X_{\bar{s}_m})
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
By the triangle inequality,
\begin{align*}
  d_E(X_s, X_t)
  &\le d_E(X_s, X_{\bar{s}_m}) + d(X_{\bar{s}_m}, X_{\bar{t}_m}) + d_E(X_{\bar{t}_m}, X_t)
  \: .
\end{align*}
\end{proof}


\begin{corollary}\label{cor:scale_change_rpow}
  \uses{def:chainingSequence}
  \leanok
  \lean{scale_change_rpow}
Let $X : T \to E$.
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers, $C_n$ a finite $\varepsilon_n$-cover of $J \subseteq T$ with $C_n \subseteq J$.
For $m \le k$,
\begin{align*}
  \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_s, X_t)^p
  &\le 2^p \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_{\bar{s}_m}, X_{\bar{t}_m})^p
    + 4^p \sup_{s \in C_k} d_E(X_s, X_{\bar{s}_m})^p
  \: .
\end{align*}
\end{corollary}

\begin{proof}\leanok
  \uses{lem:scale_change}
This is Lemma~\ref{lem:scale_change}, together with the fact that for $a, b \ge 0$,
\begin{align*}
  (a + b)^p \le (2\max(a,b))^p = 2^p \max(a^p,b^p) \le 2^p (a^p + b^p)
  \: .
\end{align*}
\end{proof}



\subsubsection{First term}


\begin{lemma}\label{lem:integral_sup_rpow_dist_cover_of_dist_le}
  \uses{def:IsKolmogorovProcess}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_cover_of_dist_le}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
Let $C$ be a finite $\varepsilon$-cover of $J \subseteq T$ with $C \subseteq J$, with minimal cardinal.
Then for $c \ge 0$,
\begin{align*}
  \mathbb{E} \left[ \sup_{s, t \in C; d_T(s, t) \le c} d_E(X_s, X_t)^p \right]
  &\le 2^{p+1} M \left(2 c \log_2 N^{int}_{\varepsilon}(J) \right)^q  N^{int}_{\varepsilon}(J)
  \: .
\end{align*}
Note the logarithm has base $2$.
\end{lemma}

\begin{proof}\leanok
  \uses{lem:integral_sup_rpow_dist_of_dist_le}
Let $\bar{r} = 1 + \log_2 N^{int}_{\varepsilon}(J)$. Then
\begin{align*}
  \vert C \vert
  = N^{int}_{\varepsilon}(J)
  \le 2^{\bar{r}}
  \: .
\end{align*}
By Lemma~\ref{lem:integral_sup_rpow_dist_of_dist_le} with $J = C$, $a = 2$, $c = c$, $n = \bar{r}$,
\begin{align*}
  \mathbb{E} \left[ \sup_{s, t \in C; d_T(s, t) \le c} d_E(X_s, X_t)^p \right]
  &\le 2^{p+1} |C| M (c \bar{r})^q
  = 2^{p+1} M (c \bar{r})^q N^{int}_{\varepsilon}(J)
  \: .
\end{align*}

Suppose $N^{int}_{\varepsilon}(J) \ge 2$ (if it equals one the result is trivial).
Then $\bar{r} \le 2 \log_2 N^{int}_{\varepsilon}(J)$.
\begin{align*}
  \mathbb{E} \left[ \sup_{s, t \in C; d_T(s, t) \le c} d_E(X_s, X_t)^p \right]
  &\le 2^{p+1} M \left(2 c \log_2 N^{int}_{\varepsilon}(J) \right)^q  N^{int}_{\varepsilon}(J)
  \: .
\end{align*}
\end{proof}

\begin{lemma}\label{lem:integral_sup_rpow_dist_cover_rescale}
  \uses{def:IsKolmogorovProcess, def:chainingSequence}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_cover_rescale}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
For all $n \in \mathbb{N}$, let $C_n$ a finite $\varepsilon_n$-cover of $J \subseteq T$ with $C_n \subseteq J$ for $\varepsilon_n = \varepsilon_0 2^{-n}$, with minimal cardinal.
Suppose $\varepsilon_0 < \infty$, let $\delta \in (0, 4 \varepsilon_0]$ and let $m = \lfloor \log_2(4\varepsilon_0/\delta) \rfloor$.
Then for $k \ge m$,
\begin{align*}
  \mathbb{E} \left[ \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_{\bar{s}_m}, X_{\bar{t}_m})^p \right]
  &\le 2^{p+1} M \left(16 \delta \log_2 N^{int}_{\delta/4}(J) \right)^q  N^{int}_{\delta/4}(J)
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:integral_sup_rpow_dist_cover_of_dist_le, cor:dist_chainingSequence_pow_two_le}
By definition of $m$, $\varepsilon_0 2^{-m} < \delta/2 \le \varepsilon_0 2^{-m+1}$.

For $s, t \in C_k$ with $d_T(s, t) \le \delta$, $d_T(\bar{s}_m, \bar{t}_m) \le \delta + \varepsilon_0 2^{-m+2} \le \varepsilon_0 2^{-m+3}$ (Corollary~\ref{cor:dist_chainingSequence_pow_two_le}).
It thus suffices to get a bound on $\mathbb{E} \left[ \sup_{s, t \in C_m; d_T(s, t) \le \varepsilon_0 2^{-m+3}} d_E(X_s, X_t)^p \right]$.

We can apply Lemma~\ref{lem:integral_sup_rpow_dist_cover_of_dist_le} with $\varepsilon = \varepsilon_m$, $c = \varepsilon_0 2^{-m+3}$. We obtain
\begin{align*}
  \mathbb{E} \left[ \sup_{s, t \in C_m; d_T(s, t) \le \varepsilon_0 2^{-m+3}} d_E(X_s, X_t)^p \right]
  &\le 2^{p+1} M \left(16 \varepsilon_0 2^{-m} \log_2 N^{int}_{\varepsilon_m}(J) \right)^q  N^{int}_{\varepsilon_m}(J)
  \: .
\end{align*}
By definition of $m$, $\varepsilon_m \ge \varepsilon_0 2^{-m} \ge \delta/4$,
hence $N^{int}_{\varepsilon_m}(J) \le N^{int}_{\delta / 4}(J)$.

Finally, by definition of $m$ we have $\varepsilon_0 2^{-m} \le \delta$.
\end{proof}



\subsubsection{Second term}


\begin{lemma}\label{lem:integral_sup_rpow_dist_succ}
  \uses{def:IsKolmogorovProcess}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_succ}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers and $C_n$ a finite $\varepsilon_n$-cover of $T$ with $C_n \subseteq T$.
Then for $j < k$,
\begin{align*}
  \mathbb{E}\left[\sup_{t \in C_k} d_E(X_{\bar{t}_j}, X_{\bar{t}_{j+1}})^p \right]
  &\le \vert C_{j+1} \vert M \varepsilon_j^q
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:dist_chainingSequence_add_one, lem:integral_sup_rpow_dist_le_card_mul_rpow}
\begin{align*}
  \mathbb{E}\left[\sup_{t \in C_k} d_E(X_{\bar{t}_j}, X_{\bar{t}_{j+1}})^p \right]
  &\le \mathbb{E}\left[\sup_{u \in C_{j+1}} d_E(X_{\bar{u}_j}, X_{u})^p \right]
  \: .
\end{align*}
We then apply Lemma~\ref{lem:integral_sup_rpow_dist_le_card_mul_rpow} to the set $C = \{(\bar{u}_j, u) \mid u \in C_{j+1}\}$, which satisfies the condition $d_T(\bar{u}_j, u) \le \varepsilon_j$ and has cardinal $\vert C_{j+1} \vert$.
\end{proof}



\paragraph{Case $p \ge 1$}


\begin{lemma}\label{lem:integral_sup_dist_le_sum_rpow}
  \uses{def:chainingSequence}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_le_sum_rpow}
Let $X : T \to \Omega \to E$ be a stochastic process.
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers and $C_n$ a finite $\varepsilon_n$-cover of $T$ with $C_n \subseteq T$.
For $p \ge 1$ and $m \le k$,
\begin{align*}
  \mathbb{E}\left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le \left(\sum_{i=m}^{k-1} \left( \mathbb{E}\left[\sup_{t \in C_k} d_E(X_{\bar{t}_i}, X_{\bar{t}_{i+1}})^p\right] \right)^{1/p}\right)^p
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
By the triangle inequality,
\begin{align*}
  \sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p
  &\le \sup_{t \in C_k} \left( \sum_{i=m}^{k-1} d_E(X_{\bar{t}_i}, X_{\bar{t}_{i+1}}) \right)^p
  \\
  &\le \left( \sum_{i=m}^{k-1} \sup_{t \in C_k} d_E(X_{\bar{t}_i}, X_{\bar{t}_{i+1}}) \right)^p
  \: .
\end{align*}
We thus have
\begin{align*}
  \left(\mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]\right)^{1/p}
  &\le \left(\mathbb{E} \left[\left( \sum_{i=m}^{k-1} \sup_{t \in C_k} d_E(X_{\bar{t}_i}, X_{\bar{t}_{i+1}}) \right)^p\right]\right)^{1/p}
  \: .
\end{align*}
And then, by Minkowski's inequality, since $p \ge 1$,
\begin{align*}
  \left(\mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]\right)^{1/p}
  &\le \sum_{i=m}^{k-1} \left( \mathbb{E}\left[\sup_{t \in C_k} d_E(X_{\bar{t}_i}, X_{\bar{t}_{i+1}})^p \right] \right)^{1/p}
  \: .
\end{align*}
Finally, we raise to the $p$-th power to obtain the result.
\end{proof}


\begin{lemma}\label{lem:integral_sup_rpow_dist_le_sum}
  \uses{def:IsKolmogorovProcess}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_le_sum}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers and $C_n$ a finite $\varepsilon_n$-cover of $T$ with $C_n \subseteq T$.
Then for $p \ge 1$ and $m \le k$,
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le M \left( \sum_{j=m}^{k-1} \vert C_{j+1} \vert^{1/p} \varepsilon_j^{q/p} \right)^p
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:integral_sup_rpow_dist_succ, lem:integral_sup_dist_le_sum_rpow}
Put together Lemma~\ref{lem:integral_sup_rpow_dist_succ} and Lemma~\ref{lem:integral_sup_dist_le_sum_rpow}.
\end{proof}


\begin{lemma}\label{lem:integral_sup_rpow_dist_le_of_minimal_cover}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_le_of_minimal_cover}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers in $(0, \mathrm{diam}(T))$ and $C_n$ a finite $\varepsilon_n$-cover of $T$ with $C_n \subseteq T$, and with minimal cardinality.
Suppose that $T$ has bounded internal covering number with constant $c_1>0$ and exponent $d > 0$.
Then for $p \ge 1$ and $m \le k$,
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le M c_1 \left( \sum_{j=m}^{k-1} \varepsilon_{j+1}^{-d/p} \varepsilon_j^{q/p} \right)^p
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:integral_sup_rpow_dist_le_sum, def:HasBoundedInternalCoveringNumber}
By Lemma~\ref{lem:integral_sup_rpow_dist_le_sum}, we have
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le M \left( \sum_{j=m}^{k-1} \vert C_{j+1} \vert^{1/p} \varepsilon_j^{q/p} \right)^p
  \: .
\end{align*}
Then by the minimality of the cardinality of $C_n$ and the bounded internal covering number hypothesis, we have
\begin{align*}
  \vert C_{j+1} \vert
  &\le N^{int}_{\varepsilon_{j+1}}(T)
  \le c_1 \varepsilon_{j+1}^{-d}
  \: .
\end{align*}
\end{proof}


\begin{corollary}\label{cor:integral_sup_rpow_dist_le_of_minimal_cover_two}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_le_of_minimal_cover_two}
Under the assumptions of Lemma~\ref{lem:integral_sup_rpow_dist_le_of_minimal_cover}, for $\varepsilon_n = \varepsilon_0 2^{-n}$, then for $m \le k$,
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le 2^d M c_1 (\varepsilon_0 2^{-m + 1})^{q - d} \frac{1}{\left( 2^{(q -d)/p} - 1\right)^p}
  \: .
\end{align*}
\end{corollary}

\begin{proof}\leanok
  \uses{lem:integral_sup_rpow_dist_le_of_minimal_cover}
Applying first Lemma~\ref{lem:integral_sup_rpow_dist_le_of_minimal_cover}, we get
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le 2^d M c_1 \varepsilon_0^{q - d} \left( \sum_{j=m}^{k-1} 2^{- j(q - d)/p} \right)^p
  \\
  &= 2^d M c_1 (\varepsilon_0 2^{-m})^{q - d} \left( \sum_{j=0}^{k-m-1} 2^{- j(q - d)/p} \right)^p
  \\
  &\le 2^d M c_1 (\varepsilon_0 2^{-m})^{q - d} \left( \sum_{j=0}^{\infty} 2^{- j(q - d)/p} \right)^p
  \\
  &= 2^d M c_1 (\varepsilon_0 2^{-m})^{q - d} \frac{1}{(1 - 2^{-(q-d)/p})^p}
  \\
  &= 2^d M c_1 (\varepsilon_0 2^{-m+1})^{q - d} \frac{1}{(2^{(q-d)/p} - 1)^p}
  \: .
\end{align*}
\end{proof}



\paragraph{Case $p \le 1$}


\begin{lemma}\label{lem:integral_sup_dist_le_sum_rpow_of_le_one}
  \uses{def:chainingSequence}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_le_sum_rpow_of_le_one}
Let $X : T \to \Omega \to E$ be a stochastic process.
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers and $C_n$ a finite $\varepsilon_n$-cover of $T$ with $C_n \subseteq T$.
For $0 < p \le 1$ and $m \le k$,
\begin{align*}
  \mathbb{E}\left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le \sum_{i=m}^{k-1} \mathbb{E}\left[\sup_{t \in C_k} d_E(X_{\bar{t}_i}, X_{\bar{t}_{i+1}})^p\right]
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
For $0 < p \le 1$, the power function is sub-additive, i.e. for $a, b \ge 0$,
\begin{align*}
  (a + b)^p \le a^p + b^p
  \: .
\end{align*}
We can thus apply the triangle inequality to obtain
\begin{align*}
  \sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p
  &\le \sup_{t \in C_k} \left(\sum_{i=m}^{k-1} d_E(X_{\bar{t}_i}, X_{\bar{t}_{i+1}})\right)^p
  \\
  &\le \sup_{t \in C_k} \sum_{i=m}^{k-1} d_E(X_{\bar{t}_i}, X_{\bar{t}_{i+1}})^p
  \\
  &\le \sum_{i=m}^{k-1} \sup_{t \in C_k} d_E(X_{\bar{t}_i}, X_{\bar{t}_{i+1}})^p
  \: .
\end{align*}
\end{proof}


\begin{lemma}\label{lem:integral_sup_rpow_dist_le_sum_of_le_one}
  \uses{def:chainingSequence}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_le_sum_of_le_one}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers and $C_n$ a finite $\varepsilon_n$-cover of $T$ with $C_n \subseteq T$.
For $0 < p \le 1$ and $m \le k$,
\begin{align*}
  \mathbb{E}\left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le M \sum_{i=m}^{k-1} \vert C_{j+1} \vert \varepsilon_j^{q}
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:integral_sup_rpow_dist_succ, lem:integral_sup_dist_le_sum_rpow_of_le_one}
Put together Lemma~\ref{lem:integral_sup_rpow_dist_succ} and Lemma~\ref{lem:integral_sup_dist_le_sum_rpow_of_le_one}.
\end{proof}


\begin{lemma}\label{lem:integral_sup_rpow_dist_le_of_minimal_cover_of_le_one}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_le_of_minimal_cover_of_le_one}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
Let $(\varepsilon_n)_{n \in \mathbb{N}}$ be a sequence of positive numbers in $(0, \mathrm{diam}(T)]$ and $C_n$ a finite $\varepsilon_n$-cover of $T$ with $C_n \subseteq T$, and with minimal cardinality.
Suppose that $T$ has bounded internal covering number with constant $c_1>0$ and exponent $d > 0$.
Then for $p \le 1$ and $m \le k$,
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le M c_1 \sum_{j=m}^{k-1} \varepsilon_{j+1}^{-d} \varepsilon_j^{q}
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:integral_sup_rpow_dist_le_sum_of_le_one, def:HasBoundedInternalCoveringNumber}
By Lemma~\ref{lem:integral_sup_rpow_dist_le_sum_of_le_one}, we have
\begin{align*}
  \mathbb{E}\left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le M \sum_{i=m}^{k-1} \vert C_{j+1} \vert \varepsilon_j^{q}
  \: .
\end{align*}
Then by the minimality of the cardinality of $C_n$ and the bounded internal covering number hypothesis, we have
\begin{align*}
  \vert C_{j+1} \vert
  &= N^{int}_{\varepsilon_{j+1}}(T)
  \le c_1 \varepsilon_{j+1}^{-d}
  \: .
\end{align*}
\end{proof}


\begin{corollary}\label{cor:integral_sup_rpow_dist_le_of_minimal_cover_two_of_le_one}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_rpow_edist_le_of_minimal_cover_two_of_le_one}
Under the assumptions of Lemma~\ref{lem:integral_sup_rpow_dist_le_of_minimal_cover_of_le_one}, for $\varepsilon_n = \varepsilon_0 2^{-n}$, then for $m \le k$,
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le 2^d M c_1 (\varepsilon_0 2^{-m + 1})^{q - d} \frac{1}{\left( 2^{(q -d)} - 1\right)}
  \: .
\end{align*}
\end{corollary}

\begin{proof}\leanok
  \uses{lem:integral_sup_rpow_dist_le_of_minimal_cover_of_le_one}
Applying first Lemma~\ref{lem:integral_sup_rpow_dist_le_of_minimal_cover_of_le_one}, we get
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le 2^d M c_1 (\varepsilon_0 2^{-m})^{q-d}\sum_{j=0}^{k-m-1} 2^{- j (q - d)}
  \\
  &\le 2^d M c_1 (\varepsilon_0 2^{-m})^{q-d}\sum_{j=0}^{+\infty} 2^{- j (q - d)}
  \\
  &= 2^d M c_1 (\varepsilon_0 2^{-m})^{q-d} \frac{1}{1 - 2^{-(q - d)}}
  \\
  &= 2^d M c_1 (\varepsilon_0 2^{-m+1})^{q-d} \frac{1}{2^{(q - d)} - 1}
  \: .
\end{align*}
\end{proof}


\paragraph{Any $p>0$}


\begin{definition}\label{def:Cp}
  \leanok
  \lean{ProbabilityTheory.Cp}
\begin{align*}
  C_p = \max\left\{\frac{1}{\left( 2^{(q -d)/p} - 1\right)^p}, \frac{1}{\left( 2^{(q -d)} - 1\right)} \right\}
  \: .
\end{align*}
\end{definition}


\begin{lemma}\label{lem:second_term_bound}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber, def:Cp}
  \leanok
  \lean{ProbabilityTheory.second_term_bound}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$.
Let $C_n$ a finite $(\varepsilon_0 2^{-n})$-cover of $T$ for $\varepsilon_0 \le \mathrm{diam}(T)$ with $C_n \subseteq T$, and with minimal cardinality.
Suppose that $T$ has bounded internal covering number with constant $c_1>0$ and exponent $d > 0$.
Then for $m \le k$,
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le 2^d M c_1 (\varepsilon_0 2^{-m + 1})^{q - d} C_p
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{cor:integral_sup_rpow_dist_le_of_minimal_cover_two_of_le_one,cor:integral_sup_rpow_dist_le_of_minimal_cover_two}
This is the max of the two bounds obtained $p \ge 1$ and $p \le 1$.
\end{proof}



\subsubsection{Putting it all together}


\begin{lemma}\label{lem:lintegral_sup_cover_eq_of_lt_iInf_dist}
  \uses{def:IsKolmogorovProcess, def:IsCover}
  \leanok
  \lean{ProbabilityTheory.lintegral_sup_cover_eq_of_lt_iInf_dist}
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$ and let $J$ be a finite subset of $T$.
Let $C$ be an $\varepsilon$-cover of $J$ with $C \subseteq J$.
If $\varepsilon < \inf_{s, t \in J; d_T(s, t)>0} d_T(s, t)$ then
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in C; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  &= \mathbb{E}\left[ \sup_{s, t \in J; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
\end{align*}
\end{lemma}

\begin{proof}\leanok
  \uses{lem:IsKolmogorovProcess.edist_eq_zero}
First, remark that $C$ is actually a $0$-cover of $J$.
For $s, t \in J$, let $s', t' \in C$ be such that $d_T(s, s') = 0$ and $d_T(t, t') = 0$.
Then by the triangle inequality,
\begin{align*}
  d_E(X_s, X_t)
  &\le d_E(X_s, X_{s'}) + d_E(X_{s'}, X_{t'}) + d_E(X_t, X_{t'})
\end{align*}
and by Lemma~\ref{lem:IsKolmogorovProcess.edist_eq_zero}, we have $d_E(X_s, X_{s'}) = 0$ and $d_E(X_t, X_{t'}) = 0$ almost surely, hence $d_E(X_s, X_t) \le d_E(X_{s'}, X_{t'})$.
Since $J$ is finite, almost surely we have that inequality for all pairs $(s, t) \in J$ and their corresponding $(s', t') \in C$.
Note that $d_T(s', t') = d_T(s, t)$, hence $d_T(s, t) \le \delta$ is equivalent to $d_T(s', t') \le \delta$.
We obtain
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in J; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  &\le \mathbb{E}\left[ \sup_{s, t \in J; d_T(s, t) \le \delta} d_E(X_{s'}, X_{t'})^p \right]
  \\
  &= \mathbb{E}\left[ \sup_{s, t \in J; d_T(s', t') \le \delta} d_E(X_{s'}, X_{t'})^p \right]
  \\
  &\le \mathbb{E}\left[ \sup_{s, t \in C; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  \: .
\end{align*}
The reverse inequality holds because $C$ is a subset of $J$.
\end{proof}


\begin{theorem}\label{thm:finite_set_bound_of_dist_le_of_diam_le}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber, def:Cp}
  \leanok
  \lean{ProbabilityTheory.finite_set_bound_of_edist_le_of_diam_le}
Suppose that $T$ is a finite set with bounded internal covering number with constant $c_1>0$ and exponent $d > 0$.
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$, with $q > d$ and $p > 0$.
For all $\delta \ge 4\mathrm{diam}(T)$,
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in T; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  \le 2^q M c_1 \delta^{q - d} C_p
  \: .
\end{align*}
\end{theorem}

\begin{proof}
  \uses{lem:second_term_bound, cor:scale_change_rpow, lem:lintegral_sup_cover_eq_of_lt_iInf_dist}
Let $\varepsilon_0 = \mathrm{diam}(T)$.
For all $n \in \mathbb{N}$, let $C_n$ a finite $\varepsilon_n$-cover of $T$ with $C_n \subseteq T$ for $\varepsilon_n = \varepsilon_0 2^{-n}$, with minimal cardinal.

Let $k = \max \left\{ 0, \left\lceil 1 + \log_2\left(\frac{\varepsilon_0}{\inf_{s, t \in J; d_T(s,t)>0}d_T(s, t)}\right) \right\rceil \right\}$.
By Lemma~\ref{lem:lintegral_sup_cover_eq_of_lt_iInf_dist}, the supremum over $T$ can be replaced by a supremum over $C_k$.

By Corollary~\ref{cor:scale_change_rpow},
\begin{align*}
  &\mathbb{E}\left[ \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  \\
  &\le 2^p \mathbb{E}\left[ \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_{\bar{s}_0}, X_{\bar{t}_0})^p \right]
    + 4^p \mathbb{E}\left[ \sup_{s \in C_k} d_E(X_s, X_{\bar{s}_0})^p \right]
  \: .
\end{align*}

Since $\varepsilon_0 = \mathrm{diam}(T)$, $C_0$ is a singleton and $d_E(X_{\bar{s}_0}, X_{\bar{t}_0}) = 0$ for all $s, t$.
We thus have
\begin{align*}
  \mathbb{E} \left[ \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_{\bar{s}_0}, X_{\bar{t}_0})^p \right]
  &= 0
  \: .
\end{align*}

By Lemma~\ref{lem:second_term_bound},
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_0})^p \right]
  &\le 2^q M c_1 \varepsilon_0^{q - d} C_p
  \le 2^q M c_1 \delta^{q - d} C_p
  \: .
\end{align*}
\end{proof}


\begin{theorem}\label{thm:finite_set_bound_of_dist_le_of_le_diam}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber, def:Cp}
  \leanok
  \lean{ProbabilityTheory.finite_set_bound_of_edist_le_of_le_diam}
Suppose that $T$ is a finite set with bounded internal covering number with constant $c_1>0$ and exponent $d > 0$.
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$, with $q > d$ and $p > 0$.
For all $\delta \in (0, 4\mathrm{diam}(T)]$,
\begin{align*}
  &\mathbb{E}\left[ \sup_{s, t \in T; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  \\
  &\le 4^{p+2q+1} M \delta^{q-d} \left(\delta^d \left(\log_2 N^{int}_{\delta/4}(T) \right)^q  N^{int}_{\delta/4}(T)
    + c_1 C_p\right)
  \: .
\end{align*}
\end{theorem}

\begin{proof}
  \uses{lem:second_term_bound, lem:integral_sup_rpow_dist_cover_rescale, cor:scale_change_rpow, lem:lintegral_sup_cover_eq_of_lt_iInf_dist, lem:IsKolmogorovProcess.lintegral_sup_rpow_edist_eq_zero}
Let $\varepsilon_0 = \mathrm{diam}(T)$.
For all $n \in \mathbb{N}$, let $C_n$ a finite $\varepsilon_n$-cover of $T$ with $C_n \subseteq T$ for $\varepsilon_n = \varepsilon_0 2^{-n}$, with minimal cardinal.

Let $k = \max \left\{ 0, \left\lceil 1 + \log_2\left(\frac{\varepsilon_0}{\inf_{s, t \in J; d_T(s,t)>0}d_T(s, t)}\right) \right\rceil \right\}$.
It satisfies $\varepsilon_0 2^{-k} < \inf_{s, t \in J; d_T(s,t)>0}d_T(s, t)$.
If $\delta \le \varepsilon_0 2^{-k}$, then $\{(s, t) \in C_k; d_T(s, t) \le \delta\} = \{(s, t) \mid s,t \in C_k, d_T(s,t) = 0\}$ and the inequality holds trivially (by Lemma~\ref{lem:IsKolmogorovProcess.lintegral_sup_rpow_edist_eq_zero}).
We can thus assume $\delta > \varepsilon_0 2^{-k}$.

By Lemma~\ref{lem:lintegral_sup_cover_eq_of_lt_iInf_dist}, the supremum over $T$ can be replaced by a supremum over $C_k$.

By Corollary~\ref{cor:scale_change_rpow}, for any $m \le k$,
\begin{align*}
  &\mathbb{E}\left[ \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  \\
  &\le 2^p \mathbb{E}\left[ \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_{\bar{s}_m}, X_{\bar{t}_m})^p \right]
    + 4^p \mathbb{E}\left[ \sup_{s \in C_k} d_E(X_s, X_{\bar{s}_m})^p \right]
  \: .
\end{align*}

\emph{First term}

We have $\delta \le 4\varepsilon_0$ by assumption.
Let $n_2 = \lfloor \log_2(4\varepsilon_0/\delta) \rfloor$ and $m = \min\{n_2, k\}$.
If $m = n_2$ then $\varepsilon_0 2^{-m} = \varepsilon_0 2^{-n_2} < \delta/2$.
Otherwise, $m = k$ and $\varepsilon_0 2^{-m} = \varepsilon_0 2^{-k} < \delta$ as argued at the start of the proof.
We thus get $\varepsilon_0 2^{-m} \le \delta$.
By Lemma~\ref{lem:integral_sup_rpow_dist_cover_rescale},
\begin{align*}
  \mathbb{E} \left[ \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_{\bar{s}_m}, X_{\bar{t}_m})^p \right]
  &\le 2^{p+1} M \left(16 \delta \log_2 N^{int}_{\delta/4}(T) \right)^q  N^{int}_{\delta/4}(T)
  \: .
\end{align*}

\emph{Second term}

By Lemma~\ref{lem:second_term_bound} and then the inequality $\varepsilon_0 2^{-m} \le \delta$,
\begin{align*}
  \mathbb{E} \left[\sup_{t \in C_k} d_E(X_t, X_{\bar{t}_m})^p \right]
  &\le 2^d M c_1 (\varepsilon_0 2^{-m+1})^{q - d} C_p
  \\
  &\le 2^q M c_1 \delta^{q - d} C_p
  \: .
\end{align*}

Putting the two terms together, we obtain
\begin{align*}
  &\mathbb{E}\left[ \sup_{s, t \in C_k; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  \\
  &\le 4^p M \left(4\left(16 \delta \log_2 N^{int}_{\delta/4}(T) \right)^q  N^{int}_{\delta/4}(T)
    + 2^q c_1 \delta^{q - d} C_p\right)
  \\
  &\le 4^{p+2q+1} M \delta^{q-d} \left(\delta^d \left(\log_2 N^{int}_{\delta/4}(T) \right)^q  N^{int}_{\delta/4}(T)
    + c_1 C_p\right)
  \: .
\end{align*}
\end{proof}


\begin{corollary}\label{cor:finite_set_bound_of_dist_le_of_le_diam_bis}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{ProbabilityTheory.finite_set_bound_of_edist_le_of_le_diam'}
With the same assumptions and notations as in Theorem~\ref{thm:finite_set_bound_of_dist_le_of_le_diam}, for all $\delta \in (0, 4\mathrm{diam}(T)]$,
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in T; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  &\le 4^{p+2q+1} M c_1 \delta^{q-d} \left(4^d \left(\log_2 \left(c_1 \delta^{-d} 4^d \right) \right)^q
    + C_p\right)
  \: .
\end{align*}
\end{corollary}

\begin{proof}\leanok
  \uses{thm:finite_set_bound_of_dist_le_of_le_diam}
We apply Theorem~\ref{thm:finite_set_bound_of_dist_le_of_le_diam} and then remark that for $\delta \le 4\mathrm{diam}(T)$, we can use the bounded internal covering number hypothesis to bound $N^{int}_{\delta/4}(T)$~:
\begin{align*}
  N^{int}_{\delta/4}(T) \le c_1 \left(\frac{\delta}{4}\right)^{-d} \: .
\end{align*}
\end{proof}


\begin{corollary}\label{cor:finite_set_bound_of_dist_le}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{ProbabilityTheory.finite_set_bound_of_edist_le}
Suppose that $T$ is a finite set with bounded internal covering number with constant $c_1>0$ and exponent $d > 0$.
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$, with $q > d$ and $p > 0$.
For all $\delta > 0$,
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in T; d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  &\le 4^{p+2q+1} M c_1 \delta^{q-d} \left(4^d \left(\max\left\{0, \log_2 \left(c_1 \delta^{-d} 4^d\right) \right\} \right)^q
    + C_p\right)
  \: .
\end{align*}
\end{corollary}


\begin{proof}\leanok
  \uses{cor:finite_set_bound_of_dist_le_of_le_diam_bis, thm:finite_set_bound_of_dist_le_of_diam_le}
We combine Corollary~\ref{cor:finite_set_bound_of_dist_le_of_le_diam_bis} and Theorem~\ref{thm:finite_set_bound_of_dist_le_of_diam_le}.
\end{proof}




\section{Kolmogorov-Chentsov Theorem}


\subsection{Sets with bounded internal covering number}

TODO: change the proofs here to avoid $s \ne t$ and use instead properties of processes satisfying the Kolmogorov condition for exponents $(p,q)$.

\begin{lemma}\label{lem:integral_div_dist_le_sum_integral_dist_le}
  \leanok
  \lean{ProbabilityTheory.lintegral_div_edist_le_sum_integral_edist_le}
Let $J \subseteq T$ be a finite set and suppose that $T$ has finite diameter.
For $k \in \mathbb{N}$, let $\eta_k = 2^{-k}(\mathrm{diam}(T) + 1)$.
For $X : T \to \Omega \to E$ a stochastic process and $\beta \in(0, (q - d)/p)$,
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in J;\: s \ne t} \frac{d_E(X_s, X_t)^p}{d_T(s, t)^{\beta p}} \right]
  &\le \sum_{k=0}^\infty 2^{k \beta p} \mathbb{E}\left[ \sup_{s, t \in J;\: s \ne t, \: d_T(s, t) \le 2 \eta_k} d_E(X_s, X_t)^p \right]
  \: .
\end{align*}
\end{lemma}

\begin{proof}\leanok
We introduce for each $k \in \mathbb{N}$ the set of pairs $(s, t)$ such that $\eta_k < d_T(s, t) \le 2 \eta_k$.
Note that $\eta_k \ge 2^{-k}$.
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in J;\: s \ne t} \frac{d_E(X_s, X_t)^p}{d_T(s, t)^{\beta p}} \right]
  &\le \sum_{k=0}^\infty \mathbb{E}\left[ \sup_{s, t \in J;\: s \ne t, \: \eta_k < d_T(s, t) \le 2 \eta_k} \frac{d_E(X_s, X_t)^p}{d_T(s, t)^{\beta p}} \right]
  \\
  &\le \sum_{k=0}^\infty \eta_k^{-\beta p} \mathbb{E}\left[ \sup_{s, t \in J;\: s \ne t, \: d_T(s, t) \le 2 \eta_k} d_E(X_s, X_t)^p \right]
  \\
  &\le \sum_{k=0}^\infty 2^{k \beta p} \mathbb{E}\left[ \sup_{s, t \in J;\: s \ne t, \: d_T(s, t) \le 2 \eta_k} d_E(X_s, X_t)^p \right]
  \: .
\end{align*}
\end{proof}


\begin{definition}\label{def:L}
  \uses{def:Cp}
  \leanok
  \lean{ProbabilityTheory.constL}
We introduce the constant
\begin{align*}
  L(T, c_1, d, p, q, \beta)
  &= 4^{p+2q+1} c_1 (\mathrm{diam}(T)+1)^{q-d}
  \\&\quad \times \sum_{k=0}^\infty 2^{k \beta p + (-k + 1)(q-d)}\left(4^d \left(\max\left\{0, \log_2(c_1) + (k + 1)d \right\}\right)^q
    + C_p\right)
  \: .
\end{align*}
\end{definition}


\begin{lemma}\label{lem:L_lt_top}
  \uses{def:L}
  \leanok
  \lean{ProbabilityTheory.constL_lt_top}
For $\mathrm{diam}(T) < \infty$, $p> 0$, $q > d > 0$ and $\beta \in (0, (q-d)/p)$, the constant $L(T, c_1, d, p, q, \beta)$ is finite.
\end{lemma}

\begin{proof}
Let $a_k = 4^{p+2q+1} M c_1 (\mathrm{diam}(T)+1)^{q-d} 2^{k \beta p + (-k + 1)(q-d)} \left(4^d \left(\max\left\{0, \log_2(c_1) + (k + 1)d \right\}\right)^q
    + C_p\right)$.
Then $L(T, c_1, d, p, q, \beta) = \sum_{k=0}^\infty a_k$.
To show that the sum is finite, we can use the ratio test.
\begin{align*}
  \frac{\vert a_{k+1} \vert}{\vert a_k \vert}
  &= 2^{\beta p - (q - d)}
    \frac{\left(4^d \left(\max\left\{0, \log_2(c_1) + (k + 2)d \right\}\right)^q + C_p\right)}
    {\left(4^d \left(\max\left\{0, \log_2(c_1) + (k + 1)d \right\}\right)^q + C_p\right)}
\end{align*}
The limit at infinity of that ratio is $2^{\beta p - (q - d)} < 1$, hence the series $\sum_{k=0}^\infty a_k$ converges.
\end{proof}


\begin{lemma}\label{lem:finite_set_bound}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber, def:L}
  \leanok
  \lean{ProbabilityTheory.finite_kolmogorov_chentsov}
Suppose that $J \subseteq T$ is a finite set and that $T$ has bounded internal covering number with constant $c_1>0$ and exponent $d > 0$.
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$, with $q > d$ and $p > 0$.
Let $\beta \in(0, (q - d)/p)$.
Then
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in J;\: s \ne t} \frac{d_E(X_s, X_t)^p}{d_T(s, t)^{\beta p}} \right]
  \le M L(T, c_1, d, p, q, \beta)
  < \infty
  \: .
\end{align*}
\end{lemma}

\begin{proof}
  \uses{cor:finite_set_bound_of_dist_le, lem:integral_div_dist_le_sum_integral_dist_le, lem:L_lt_top}
Let $\eta_k = 2^{-k}(\mathrm{diam}(T) + 1)$ for $k \in \mathbb{N}$.
By Lemma~\ref{lem:integral_div_dist_le_sum_integral_dist_le}, we have
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in J;\: s \ne t} \frac{d_E(X_s, X_t)^p}{d_T(s, t)^{\beta p}} \right]
  &\le \sum_{k=0}^\infty 2^{k \beta p} \mathbb{E}\left[ \sup_{s, t \in J;\: s \ne t, \: d_T(s, t) \le 2 \eta_k} d_E(X_s, X_t)^p \right]
  \: .
\end{align*}
We apply Corollary~\ref{cor:finite_set_bound_of_dist_le} to bound each expectation in the sum.
\begin{align*}
  &\mathbb{E}\left[ \sup_{s, t \in J;\: s \ne t, \: d_T(s, t) \le 2 \eta_k} d_E(X_s, X_t)^p \right]
  \\
  &\le 4^{p+2q+1} M c_1 (2 \eta_k)^{q-d} \left(4^d \left(\max\left\{0, \log_2 \left(c_1 (2 \eta_k)^{-d} 4^d \right) \right\} \right)^q
    + C_p\right)
  \\
  &\le 4^{p+2q+1} M c_1 (\mathrm{diam}(T)+1)^{q-d} 2^{(-k + 1)(q-d)} \left(4^d \left(\max\left\{0, \log_2 \left(c_1 2^{(k + 1)d} \right) \right\} \right)^q
    + C_p\right)
  \\
  &= 4^{p+2q+1} M c_1 (\mathrm{diam}(T)+1)^{q-d} 2^{(-k + 1)(q-d)} \left(4^d \left(\max\left\{0, \log_2(c_1) + (k + 1)d \right\} \right)^q
    + C_p\right)
  \: .
\end{align*}
The sum is then less than $M$ times $L(T, c_1, d, p, q, \beta)$.
\end{proof}


\begin{theorem}\label{thm:countable_set_bound}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{ProbabilityTheory.countable_kolmogorov_chentsov}
Suppose that $T$ has bounded internal covering number with constant $c_1>0$ and exponent $d > 0$.
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition for exponents $(p,q)$ with constant $M$, with $q > d$ and $p > 0$.
Let $\beta \in(0, (q - d)/p)$.
Then for every countable subset $T' \subseteq T$ with positive diameter,
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in T';\: s \ne t} \frac{d_E(X_s, X_t)^p}{d_T(s, t)^{\beta p}} \right]
  \le M L(T, c_1, d, p, q, \beta)
  \: .
\end{align*}
\end{theorem}

\begin{proof}
  \uses{lem:finite_set_bound}
Build a monotone sequence of finite sets $T_n \subseteq T'$, use Lemma~\ref{lem:finite_set_bound} to obtain a bound for each $T_n$ that does not depend on $T_n$, and then use monotone convergence.
\end{proof}


\begin{corollary}\label{cor:countable_set_bound_of_le}
Under the same assumptions as in Theorem~\ref{thm:countable_set_bound}, for every countable subset $T' \subseteq T$ with positive diameter, for $L(T, c_1, d, p, q, \beta) < \infty$ the same constant,
\begin{align*}
  \mathbb{E}\left[ \sup_{s, t \in T';\: d_T(s, t) \le \delta} d_E(X_s, X_t)^p \right]
  \le M L(T, c_1, d, p, q, \beta) \delta^{\beta p}
  \: .
\end{align*}
\end{corollary}

\begin{proof}
  \uses{thm:countable_set_bound}
Immediately follows from Theorem~\ref{thm:countable_set_bound}.
\end{proof}


\begin{lemma}\label{lem:holder_modification_single}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{ProbabilityTheory.exists_modification_holder_aux}
Under the assumptions of Theorem~\ref{thm:countable_set_bound}, for $E$ a complete space and $\beta \in (0, (q - d)/p)$, there exists a modification $Y$ of $X$ (i.e., a process $Y$ with $\mathbb{P}(Y_t \ne X_t) = 0$ for all $t$) such that the paths of $Y$ are HÃ¶lder continuous of order $\beta$.
\end{lemma}

\begin{proof}
  \uses{thm:countable_set_bound}
Let $T'$ be a countable dense subset of $T$.
Let $A$ be the event
\begin{align*}
  \left\{\sup_{s, t \in T';\: s \ne t} \frac{d_E(X_s, X_t)^p}{d_T(s, t)^{\beta p}} < \infty \right\}
  \: .
\end{align*}
As a consequence of Theorem~\ref{thm:countable_set_bound}, we have $\mathbb{P}(A) = 1$.

On the event $A$, $(X_t)_{t \in T'}$ has HÃ¶lder continuous paths of order $\beta$.
Let $x_0 \in E$ be arbitrary and let $Y: T \to \Omega \to E$ be the process defined by
\begin{align*}
  Y_t(\omega)
  &= \begin{cases}
    \lim_{s \to t, s \in T'} X_s(\omega) & \text{if } \omega \in A \\
    x_0 & \text{otherwise}
  \end{cases}
  \: .
\end{align*}
Then $Y$ has HÃ¶lder continuous paths of order $\beta$ almost surely.

We can show that $(Y_s, Y_t)$ is $\mathbb{P}$-a.e. measurable for all $s, t \in T$.

It remains to show that $Y$ is a modification of $X$.
Let then $t \in T$ and let $(t_n)_{n \in \mathbb{N}}$ be a sequence in $T'$ that converges to $t$.
We want to show that $\mathbb{P}(Y_t \ne X_t) = 0$.
It suffices to show that $\mathbb{P}(d_E(Y_t, X_t) > 0) = 0$, which itself would follow from $\mathbb{P}(d_E(Y_t, X_t) > \varepsilon) = 0$ for all $\varepsilon > 0$.

\begin{align*}
  \mathbb{P}(d_E(Y_t, X_t) > \varepsilon)
  &\le \mathbb{P}(d_E(Y_t, X_{t_n}) + d_E(X_{t_n}, X_t) > \varepsilon)
  \\
  &\le \mathbb{P}(d_E(Y_t, X_{t_n}) > \varepsilon/2) + \mathbb{P}(d_E(X_{t_n}, X_t) > \varepsilon/2)
  \: .
\end{align*}

TODO
\end{proof}


\begin{theorem}\label{thm:holder_modification}
  \uses{def:IsKolmogorovProcess, def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{ProbabilityTheory.exists_modification_holder}
Under the assumptions of Theorem~\ref{thm:countable_set_bound}, for $E$ a complete space, there exists a modification $Y$ of $X$ (i.e., a process $Y$ with $\mathbb{P}(Y_t \ne X_t) = 0$ for all $t$) such that the paths of $Y$ are HÃ¶lder continuous of all orders $\gamma \in (0, (q - d)/p)$.
\end{theorem}

\begin{proof}
  \uses{lem:holder_modification_single, lem:indistinguishable_of_modification_of_continuous}
Let $(\beta_n)$ be an increasing sequence of numbers in $(0, (q - d)/p)$ such that $\beta_n \to (q - d)/p$.
For each $n$, let $Y^n$ be the modification of $X$ given by Lemma~\ref{lem:holder_modification_single} for $\beta = \beta_n$.
Then by Lemma~\ref{lem:indistinguishable_of_modification_of_continuous}, the processes $Y^0$ and $Y^n$ are indistinguishable for all $n$.
That is, there exists an event $A_n$ such that $\mathbb{P}(A_n) = 1$ and such that for all $\omega \in A_n$, $Y^0_t(\omega) = Y^n_t(\omega)$ for all $t \in T$.

Let $A = \bigcap_{n \in \mathbb{N}} A_n$ and let $x_0 \in E$ be arbitrary.
Then $\mathbb{P}(A) = 1$ and the process $Y(\omega) = Y^0(\omega)$ for $\omega \in A$ and $Y(\omega) = x_0$ for $\omega \notin A$ has paths that are HÃ¶lder continuous of all orders $\gamma \in (0, (q - d)/p)$.
\end{proof}



\subsection{Localized Kolmogorov-Chentsov theorem}

\begin{definition}[Cover with bounded covering numbers]\label{def:HasBoundedCoveringNumberCover}
  \uses{def:HasBoundedInternalCoveringNumber}
  \leanok
  \lean{IsCoverWithBoundedCoveringNumber}
A set $T$ is said to have a cover with bounded covering numbers if there exists a monotone sequence of totally bounded subsets $(T_n)_{n \in \mathbb{N}}$ of $T$ such that for all $n$, $T_n$ has bounded internal covering number with constant $c_n$ and exponent $d_n > 0$, and such that $T \subseteq \bigcup_{n \in \mathbb{N}} T_n$.
\end{definition}


\begin{lemma}\label{lem:hasBoundedCoveringNumberCover_nnreal}
  \uses{def:HasBoundedCoveringNumberCover}
  \leanok
  \lean{isCoverWithBoundedCoveringNumber_Ico_nnreal}
$\mathbb{R}_+$ has a cover with bounded covering numbers for the sets $T_n = [0,n)$, constants $c_n = n$ and exponents $d_n = 1$.
\end{lemma}

\begin{proof}
  \uses{lem:hasBoundedInternalCoveringNumber_unitInterval}

\end{proof}


\begin{theorem}\label{thm:localized_holder_modification}
  \uses{def:IsKolmogorovProcess, def:HasBoundedCoveringNumberCover}
  \leanok
  \lean{ProbabilityTheory.exists_modification_holder'}
Let $T$ be a metric space with a cover $(T_n)$ with bounded covering numbers with constants $c_n$ and the same exponent $d$.
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition with exponents $(p, q)$ with $q > d$.
Then $X$ has a modification $Y$ such that almost surely the paths of $Y$ are HÃ¶lder continuous of all orders $\gamma \in (0, (q - d)/p)$.
\end{theorem}

\begin{proof}
  \uses{thm:holder_modification, lem:indistinguishable_of_modification_of_continuous}
For each $n$, by Theorem~\ref{thm:holder_modification} there is a modification $Y_n$ of $X$ seen as a process on $T_n$ such that the paths of $Y_n$ are HÃ¶lder continuous of all orders $\gamma \in (0, (q - d)/p)$.
By Lemma~\ref{lem:indistinguishable_of_modification_of_continuous}, $Y_n$ and $Y_{n+1}$ are indistinguishable on $T_n$.
That is, almost surely $Y_n = Y_{n+1}$ on $T_n$.
Since there are countably many such almost sure equalities, we get that almost surely there is equality for all $n$.
Let $A$ be the event that this happens, let $x_0 \in E$ be arbitrary and define a process $Y : T \to \Omega \to E$ by
\begin{align*}
  Y(t, \omega)
  &= \begin{cases}
    Y_n(t, \omega) & \text{if } \omega \in A \: , \: t \in T_n \setminus T_{n-1} \: ,
    \\
    x_0 & \text{if } \omega \notin A \: .
  \end{cases}
\end{align*}
Then $Y$ is a modification of $X$ and has paths that are HÃ¶lder continuous of all orders $\gamma \in (0, (q - d)/p)$ almost surely.
\end{proof}


\begin{theorem}\label{thm:localized_holder_modification_sup}
  \uses{def:IsKolmogorovProcess, def:HasBoundedCoveringNumberCover}
  \leanok
  \lean{ProbabilityTheory.exists_modification_holder_iSup}
Let $T$ be a metric space with a cover $(T_n)$ with bounded covering numbers with constants $c_n$ and the same exponent $d$.
Let $(p_n, q_n)_{n \in \mathbb{N}}$ be a sequence of pairs of positive numbers such that $q_n > d$ for all $n \in \mathbb{N}$.
Let $X : T \to \Omega \to E$ be a process that satisfies the Kolmogorov condition with exponents $(p_n, q_n)$ for all $n \in \mathbb{N}$.
Then $X$ has a modification $Y$ such that almost surely the paths of $Y$ are HÃ¶lder continuous of all orders $\gamma \in (0, \sup_n (q_n - d)/p_n)$.
\end{theorem}

\begin{proof}
  \uses{thm:localized_holder_modification}
For each $n$, by Theorem~\ref{thm:localized_holder_modification} there is a modification $Y_n$ of $X$ such that the paths of $Y_n$ are HÃ¶lder continuous of all orders $\gamma \in (0, (q_n - d)/p_n)$.
By Lemma~\ref{lem:indistinguishable_of_modification_of_continuous}, any two processes $Y_n, Y_m$ are indistinguishable.
That is, almost surely $Y_n = Y_m$.
Since there are countably many such almost sure equalities, we get that almost surely there is equality for all $n, m$.
Let then $Y$ be the process equal to $Y_0$ on the event that the equalities hold, and equal to an arbitrary point $x_0 \in E$ otherwise.
Then first, $Y$ is a modification of $X$.
Then for any $\gamma < \sup_n (q_n - d)/p_n$ there is $n$ such that $\gamma < (q_n - d)/p_n$ and thus since $Y = Y_n$ the paths of $Y$ are HÃ¶lder continuous of order $\gamma$ almost surely.
\end{proof}
